<!DOCTYPE html><html lang="ru"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Журналы</title><link rel="manifest" href="manifest.json"><meta name="theme-color" content="#ffffff"/><link rel="apple-touch-icon" href="icon.png"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet"><script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script><style>:root{--border-radius:1rem;--transition-speed:0.4s;--font-family:'Inter',sans-serif;--bg-color-light:linear-gradient(145deg, #f5f7fa, #e8f0f5);--surface-color-light:rgba(255, 255, 255, 0.75);--text-color-light:#1c1c1e;--text-secondary-color-light:#5a6470;--border-color-light:rgba(0, 0, 0, 0.1);--shadow-color-light:rgba(100, 100, 150, 0.1);--accent-gradient-light:linear-gradient(45deg, #0dcaf0, #0d6efd);--accent-color-primary-light:#0dcaf0;--accent-rgb-light:13, 202, 240;--bg-color-dark:linear-gradient(145deg, #0a0c16, #1a1f33);--surface-color-dark:rgba(30, 41, 59, 0.7);--text-color-dark:#e8e8e8;--text-secondary-color-dark:#8b949e;--border-color-dark:rgba(139, 148, 158, 0.2);--shadow-color-dark:rgba(0, 0, 0, 0.3);--accent-gradient-dark:linear-gradient(45deg, #0dcaf0, #0d6efd);--accent-color-primary-dark:#0dcaf0;--accent-rgb-dark:13, 202, 240;--bg-image-glass:url('https://images.unsplash.com/photo-1756206872838-29593d5e53a7?q=80&w=1227&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');--surface-color-glass:rgba(0, 0, 0, 0.25);--text-color-glass:#ffffff;--text-secondary-color-glass:rgba(255, 255, 255, 0.7);--border-color-glass:rgba(255, 255, 255, 0.2);--shadow-color-glass:rgba(0, 0, 0, 0.37);}html{font-size:100%;}*{box-sizing:border-box;margin:0;padding:0;}body{font-family:var(--font-family);background:var(--bg-color-light);color:var(--text-color-light);transition:background .6s, color var(--transition-speed);font-size:0.95rem;background-size:cover;background-attachment:fixed;}body.dark-mode{background:var(--bg-color-dark);color:var(--text-color-dark);}body.glass-mode{background-image:var(--bg-image-glass);background-color:#0b111e;color:var(--text-color-glass);}.container{max-width:1400px;margin:0 auto;padding:1rem;}#selection-page{display:flex;flex-direction:column;justify-content:center;align-items:center;min-height:80vh;text-align:center;}.selection-title{font-size:2rem;margin-bottom:2rem;}.selection-grid{display:grid;grid-template-columns:1fr;gap:1.5rem;width:100%;max-width:400px;}@media(min-width: 600px){.selection-grid{grid-template-columns:1fr 1fr;}}header{display:flex;justify-content:space-between;align-items:center;height:3.3rem;margin-bottom:0.7rem;padding:0 0.7rem;gap:1rem;}.header-left,.header-right{display:flex;align-items:center;gap:1rem;}.glass-container{background:var(--surface-color-light);backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);padding:1.3rem;border-radius:var(--border-radius);margin-bottom:1.3rem;border:1px solid var(--border-color-light);box-shadow:0 0.5rem 2rem 0 var(--shadow-color-light);transition:all var(--transition-speed);}body.dark-mode .glass-container{background:var(--surface-color-dark);border-color:var(--border-color-dark);box-shadow:0 0.5rem 2rem 0 var(--shadow-color-dark);}body.glass-mode .glass-container{background:var(--surface-color-glass);border-color:var(--border-color-glass);box-shadow:0 0.5rem 2rem 0 var(--shadow-color-glass);}button{border-radius:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s;color:#fff;border:none;}.btn-primary{background:var(--accent-gradient-light);padding:0.8rem 1.2rem;font-size:1em;background-size:200% auto;}.btn-primary:hover{background-position:right center;}body.dark-mode .btn-primary,body.glass-mode .btn-primary{background:var(--accent-gradient-dark);background-size:200% auto;}input::-webkit-calendar-picker-indicator{filter:grayscale(1) opacity(0.5);cursor:pointer;}body.dark-mode input::-webkit-calendar-picker-indicator,body.glass-mode input::-webkit-calendar-picker-indicator{filter:invert(1) opacity(0.5);}.icon-btn{background:transparent;border:1px solid var(--border-color-light);width:2.8rem;height:2.8rem;display:flex;justify-content:center;align-items:center;padding:0;}body.dark-mode .icon-btn{border-color:var(--border-color-dark);color:var(--text-color-dark);}body.glass-mode .icon-btn{border-color:var(--border-color-glass);color:var(--text-color-glass);}.icon-btn svg{width:1.3rem;height:1.3rem;stroke:var(--text-secondary-color-light);}body.dark-mode .icon-btn svg{stroke:var(--text-secondary-color-dark);}body.glass-mode .icon-btn svg{stroke:var(--text-secondary-color-glass);}input[type="text"],input[type="date"],input[type="number"]{background-color:var(--surface-color-light);border:1px solid var(--border-color-light);border-radius:0.8rem;padding:0.9rem;font-size:1rem;color:var(--text-color-light);width:100%;}body.dark-mode input[type="text"],body.dark-mode input[type="date"],body.dark-mode input[type="number"]{background-color:var(--surface-color-dark);border-color:var(--border-color-dark);color:var(--text-color-dark);}body.glass-mode input[type="text"],body.glass-mode input[type="date"],body.glass-mode input[type="number"]{background-color:var(--surface-color-glass);border-color:var(--border-color-glass);color:var(--text-color-glass);}input:focus{outline:none;border-color:var(--accent-color-primary-light);box-shadow:0 0 0 0.25rem rgba(var(--accent-rgb-light), 0.2);}body.dark-mode input:focus,body.glass-mode input:focus{border-color:var(--accent-color-primary-dark);box-shadow:0 0 0 0.25rem rgba(var(--accent-rgb-dark), 0.25);}.table-wrapper{overflow-x:auto;}.sample-table-content{display:table;min-width:1850px;}.seals-table-content{display:table;min-width:100%;}.table-header,.table-row{display:flex;align-items:stretch;border-bottom:1px solid var(--border-color-light);padding:0.5rem 0;}body.dark-mode .table-header,body.dark-mode .table-row{border-bottom-color:var(--border-color-dark);}body.glass-mode .table-header,body.glass-mode .table-row{border-bottom-color:var(--border-color-glass);}.table-header{font-weight:700;color:var(--text-secondary-color-light);font-size:0.8rem;padding:0.5rem;}body.dark-mode .table-header{color:var(--text-secondary-color-dark);}body.glass-mode .table-header{color:var(--text-secondary-color-glass);}.cell{padding:0.8rem 0.5rem;display:flex;align-items:center;word-break:break-word;white-space:normal;flex-shrink:0;}.cell-select{width:50px;justify-content:center;}.cell-id{width:40px;}.cell-date{width:110px;}.cell-inspector,.cell-executor{width:130px;}.cell-batch,.cell-cont,.cell-jar{width:100px;}.cell-tare,.cell-gross,.cell-net,.cell-u,.cell-u235{width:120px;}.cell-enrich,.cell-conc{width:110px;}.cell-pkg,.cell-seal{width:100px;}.cell-action{width:100px;justify-content:center;}.seals-cell-id{width:5%;}.seals-cell-seal{width:25%;}.seals-cell-date{width:25%;}.seals-cell-pkg{width:25%;}.seals-cell-executor{width:20%;}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);backdrop-filter:blur(5px);display:flex;justify-content:center;align-items:center;opacity:0;visibility:hidden;z-index:1000;}.modal-overlay.visible{opacity:1;visibility:visible;}.modal-content{width:90%;max-width:800px;max-height:90vh;overflow-y:auto;}.fab{position:fixed;bottom:2rem;right:2rem;width:3.5rem;height:3.5rem;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:1.8rem;box-shadow:0 0.25rem 1.25rem rgba(0,0,0,0.3);z-index:999;}#notification-container{position:fixed;top:1.25rem;left:50%;transform:translateX(-50%);z-index:2000;width:90%;max-width:400px;}.notification{padding:1rem 1.5rem;border-radius:var(--border-radius);text-shadow:0 1px 2px rgba(0,0,0,0.3);box-shadow:0 0.5rem 2rem 0 rgba(0,0,0,0.2);opacity:0;transform:translateY(-20px);transition:all 0.5s;}.notification.show{opacity:1;transform:translateY(0);}.notification-buttons{margin-top:1rem;display:flex;gap:0.5rem;justify-content:flex-end;}.notification-btn{border:1px solid rgba(0,0,0,0.1);padding:0.5rem 1rem;color:var(--text-color-light);background:rgba(0,0,0,0.05);}body.dark-mode .notification-btn,body.glass-mode .notification-btn{color:var(--text-color-dark);border-color:rgba(255,255,255,0.3);background:rgba(255,255,255,0.2);}.summary-grid{display:grid;grid-template-columns:repeat(auto-fit, minmax(240px, 1fr));gap:1rem;}.summary-item{text-align:center;}.summary-item-text strong{font-size:1.3em;margin-left:0.5rem;}.theme-switch{width:2.2rem;height:2.2rem;border-radius:50%;}#scale-slider{-webkit-appearance:none;appearance:none;width:8rem;height:0.5rem;background:var(--border-color-light);outline:none;border-radius:0.25rem;}body.dark-mode #scale-slider,body.glass-mode #scale-slider{background:var(--border-color-dark);}#scale-slider::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:1.25rem;height:1.25rem;border-radius:50%;background:var(--accent-color-primary-light);cursor:pointer;}body.dark-mode #scale-slider::-webkit-slider-thumb,body.glass-mode #scale-slider::-webkit-slider-thumb{background:var(--accent-color-primary-dark);}.prefixed-input{display:flex;align-items:center;border:1px solid var(--border-color-light);border-radius:0.8rem;background:var(--surface-color-light);}body.dark-mode .prefixed-input{border-color:var(--border-color-dark);background:var(--surface-color-dark);}body.glass-mode .prefixed-input{border-color:var(--border-color-glass);background:var(--surface-color-glass);}.input-prefix{padding:0 0.8rem;font-size:1rem;color:var(--text-secondary-color-light);}body.dark-mode .input-prefix{color:var(--text-secondary-color-dark);}body.glass-mode .input-prefix{color:var(--text-secondary-color-glass);}.prefixed-input input{border:none!important;box-shadow:none!important;padding-left:0!important;background:transparent!important;}.summary-wrapper{overflow:hidden;position:relative;}.summary-slider{display:flex;width:200%;transition:transform var(--transition-speed) ease;}.summary-slide{width:50%;flex-shrink:0;}.summary-dots{display:flex;justify-content:center;gap:8px;margin-top:1rem;}.dot{width:8px;height:8px;border-radius:50%;background-color:var(--border-color-light);transition:all var(--transition-speed);cursor:pointer;}body.dark-mode .dot,body.glass-mode .dot{background-color:var(--border-color-dark);}.dot.active{background:var(--accent-color-primary-light);}body.dark-mode .dot.active,body.glass-mode .dot.active{background:var(--accent-color-primary-dark);}.container-card{border:1px solid var(--border-color-light);padding:1rem;border-radius:var(--border-radius);text-align:left;}body.dark-mode .container-card{border-color:var(--border-color-dark);}body.glass-mode .container-card{border-color:var(--border-color-glass);}.container-card h3{font-size:1.2em;color:var(--accent-color-primary-light);margin-bottom:1rem;}body.dark-mode .container-card h3,body.glass-mode .container-card h3{color:var(--accent-color-primary-dark);}.container-card p{font-size:0.9em;margin-top:0.5rem;}.theme-switcher{position:relative;width:2.8rem;height:2.8rem;}.theme-icon{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);transition:opacity 0.3s, transform 0.3s;}</style></head><body><div id="selection-page" class="container" hidden><h1 class="selection-title">Выберите журнал</h1><div class="selection-grid"><button id="open-samples-btn" class="btn-primary glass-container" style="padding: 2rem; font-size: 1.2rem;">Журнал проб</button><button id="open-seals-btn" class="btn-primary glass-container" style="padding: 2rem; font-size: 1.2rem;">Журнал пломб</button></div></div><div id="samples-page" class="container" hidden><header><div class="header-left"><button id="back-to-selection-from-samples" class="icon-btn" title="Назад к выбору"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></button><h2 style="margin:0;">Журнал проб</h2></div><div class="header-right"><input type="range" min="80" max="130" value="100" id="scale-slider-samples" title="Масштаб интерфейса"><div id="theme-switcher-samples" class="theme-switcher icon-btn" title="Сменить тему"><svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#ffc107"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg><svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#e0e0e0"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg><svg class="theme-icon glass-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#ffffff"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M8 3v18"></path><path d="M16 3v18"></path><path d="M3 8h18"></path><path d="M3 16h18"></path></svg></div></div></header><main><div class="table-container glass-container"><div style="display:flex;gap:0.7rem;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:1.3rem"><div class="search-wrapper" style="position:relative;flex-grow:1;min-width:200px"><svg style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);width:1.25rem;height:1.25rem" class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" id="search-input-samples" placeholder="Поиск в журнале..." style="padding-left:3rem"></div><div style="display:flex;gap:0.7rem"><button id="import-btn-samples" class="icon-btn" title="Импорт из Excel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg></button><button id="export-btn-samples" class="icon-btn" title="Экспорт в Excel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></button><button id="save-btn-samples" class="icon-btn" title="Сохранить изменения"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg></button><button id="delete-all-btn-samples" class="icon-btn" title="Удалить все"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button></div></div><div class="table-wrapper"><div class="sample-table-content"><div class="table-header"><div class="cell cell-select"><input type="checkbox" id="select-all-checkbox-samples" title="Выбрать все"></div><div class="cell cell-id">№</div><div class="cell cell-date">Дата</div><div class="cell cell-inspector">Инспектор</div><div class="cell cell-executor">Исполнитель</div><div class="cell cell-batch">№ партии</div><div class="cell cell-cont">№ конт.</div><div class="cell cell-jar">№ банки</div><div class="cell cell-tare">Масса тары</div><div class="cell cell-gross">Масса брутто</div><div class="cell cell-net">Нетто</div><div class="cell cell-enrich">Обогащ.</div><div class="cell cell-conc">Концентр.</div><div class="cell cell-u">Масса U</div><div class="cell cell-u235">Масса U235</div><div class="cell cell-pkg">№ упак.</div><div class="cell cell-seal">№ пломбы</div><div class="cell cell-action">Действие</div></div><div class="table-body" id="samples-table-body"></div></div></div><input type="file" id="import-file-input-samples" accept=".xlsx,.xls" style="display:none"></div></main><footer class="glass-container"><div class="summary-wrapper" id="summary-wrapper-samples"><div class="summary-slider" id="summary-slider-samples"><div class="summary-slide"><div class="summary-grid"><div class="summary-item glass-container"><div class="summary-item-text"><span>Всего проб&nbsp;&nbsp;</span><strong id="total-samples">0</strong></div></div><div class="summary-item glass-container"><div class="summary-item-text"><span>Итого масса U&nbsp;&nbsp;</span><strong id="total-u-weight">0.0000 г</strong></div></div><div class="summary-item glass-container"><div class="summary-item-text"><span>Итого масса U235&nbsp;&nbsp;</span><strong id="total-u235-weight">0.0000 г</strong></div></div></div></div><div class="summary-slide"><div class="summary-grid" id="container-summary-grid"></div></div></div><div class="summary-dots" id="summary-dots-samples"><div class="dot active"></div><div class="dot"></div></div></div></footer></div><div id="seals-page" class="container" hidden><header><div class="header-left"><button id="back-to-selection-from-seals" class="icon-btn" title="Назад к выбору"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></button><h2 style="margin:0;">Журнал пломб</h2></div><div class="header-right"><input type="range" min="80" max="130" value="100" id="scale-slider-seals" title="Масштаб интерфейса"><div id="theme-switcher-seals" class="theme-switcher icon-btn" title="Сменить тему"><svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#ffc107"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg><svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#e0e0e0"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg><svg class="theme-icon glass-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="stroke:#ffffff"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M8 3v18"></path><path d="M16 3v18"></path><path d="M3 8h18"></path><path d="M3 16h18"></path></svg></div></div></header><main><div class="table-container glass-container"><div style="display:flex;gap:0.7rem;flex-wrap:wrap;justify-content:space-between;align-items:center;margin-bottom:1.3rem"><div class="search-wrapper" style="position:relative;flex-grow:1;min-width:200px"><svg style="position:absolute;left:1rem;top:50%;transform:translateY(-50%);width:1.25rem;height:1.25rem" class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><input type="text" id="search-input-seals" placeholder="Поиск в журнале..." style="padding-left:3rem"></div><div style="display:flex;gap:0.7rem"><button id="export-btn-seals" class="icon-btn" title="Экспорт в Excel"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></button></div></div><div class="table-wrapper"><div class="seals-table-content"><div class="table-header"><div class="cell cell-select"><input type="checkbox" id="select-all-checkbox-seals" title="Выбрать все"></div><div class="cell seals-cell-id">№</div><div class="cell seals-cell-seal">Номер пломбы</div><div class="cell seals-cell-date">Дата установки</div><div class="cell seals-cell-pkg">Номер упак. контейнера</div><div class="cell seals-cell-executor">Кто установил</div></div><div class="table-body" id="seals-table-body"></div></div></div></div></main></div><div class="modal-overlay" id="add-modal"><div class="form-container glass-container modal-content"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1.3rem"><h2 style="border:none;padding:0;margin:0;font-weight:700">Новая проба</h2><button id="modal-close-btn" class="icon-btn" style="width:2.5rem;height:2.5rem;border-radius:50%;font-size:1.5rem">&times;</button></div><form id="add-sample-form"><div class="form-grid" style="display:grid;grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));gap:1rem"><div class="form-group"><label for="date">Дата</label><input type="date" id="date" required></div><div class="form-group"><label for="executor">Исполнитель</label><input type="text" id="executor" placeholder="Исполнитель"></div><div class="form-group"><label for="inspector">Инспектор</label><input type="text" id="inspector" placeholder="Инспектор"></div><div class="form-group"><label for="batch-number">Номер партии</label><input type="text" id="batch-number" placeholder="Номер партии"></div><div class="form-group"><label for="container-number">Номер контейнера</label><input type="text" id="container-number" placeholder="Номер контейнера"></div><div class="form-group"><label for="jar-number">Номер баночки</label><input type="text" id="jar-number" placeholder="Номер баночки"></div><div class="form-group"><label for="tare-weight">Масса тары, г</label><input type="number" step="0.0001" id="tare-weight" placeholder="0.0000" required></div><div class="form-group"><label for="gross-weight">Масса брутто, г</label><input type="number" step="0.0001" id="gross-weight" placeholder="0.0000" required></div><div class="form-group"><label for="enrichment">Обогащение, %</label><input type="number" step="0.0001" id="enrichment" placeholder="0.0000"></div><div class="form-group"><label for="concentration">Концентрация, %</label><input type="number" step="0.0001" id="concentration" placeholder="0.0000"></div><div class="form-group"><label for="package-container-number">Номер упак, контейнера</label><div class="prefixed-input"><span class="input-prefix">Т-</span><input type="text" id="package-container-number"></div></div><div class="form-group"><label for="seal-number">Номер пломбы (S)</label><input type="text" id="seal-number" placeholder="Номер пломбы" maxlength="6"></div><div class="form-group"><label for="next-movement">Дальнейшее движение</label><input type="text" id="next-movement" placeholder="Дальнейшее движение"></div></div><button type="submit" class="btn-primary" style="width:100%;margin-top:1.3rem">Добавить пробу</button></form></div></div><button class="fab btn-primary" id="fab-add-btn" title="Добавить новую запись" style="display: none;"></button><div id="notification-container"></div><script>document.addEventListener("DOMContentLoaded",()=>{const e=e=>{["selection-page","samples-page","seals-page"].forEach(e=>{const t=document.getElementById(e);t&&(t.style.display="none")}),document.getElementById("fab-add-btn").style.display="none";const t=document.getElementById(e);t&&(t.style.display="selection-page"===e?"flex":"block"),"samples-page"===e&&(document.getElementById("fab-add-btn").style.display="flex"),window.scrollTo(0,0)},t=e=>{if(!e||"string"!=typeof e)return"";const t=e.split("-");return 3!==t.length?e:`${t[2]}.${t[1]}.${t[0]}`},n=e=>{if(!e||"string"!=typeof e)return new Date;const t=e.split(".");return 3===t.length?new Date(`${t[2]}-${t[1]}-${t[0]}`):new Date(e)};e("selection-page"),document.getElementById("open-samples-btn").addEventListener("click",()=>e("samples-page")),document.getElementById("open-seals-btn").addEventListener("click",()=>e("seals-page")),document.getElementById("back-to-selection-from-samples").addEventListener("click",()=>e("selection-page")),document.getElementById("back-to-selection-from-seals").addEventListener("click",()=>e("selection-page")),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js").catch(e=>console.log("SW reg failed:",e))});let o=JSON.parse(localStorage.getItem("samples"))||[];const a=["light","dark","glass"];let c=0;const l=e=>{document.body.classList.remove("dark-mode","glass-mode"),document.querySelectorAll(".sun-icon, .moon-icon, .glass-icon").forEach(e=>e.style.opacity="0"),"dark"===e?(document.body.classList.add("dark-mode"),document.querySelectorAll(".moon-icon").forEach(e=>e.style.opacity=1)):"glass"===e?(document.body.classList.add("glass-mode"),document.querySelectorAll(".glass-icon").forEach(e=>e.style.opacity=1)):document.querySelectorAll(".sun-icon").forEach(e=>e.style.opacity=1),localStorage.setItem("theme",e)},r=e=>{document.documentElement.style.fontSize=`${e}%`,document.getElementById("scale-slider-samples").value=e,document.getElementById("scale-slider-seals").value=e,localStorage.setItem("scale",e)},s=(e,n)=>{const o=document.createElement("div");o.className="table-row";const a=(e.netWeight||0)*(e.concentration||0)/100,c=a*(e.enrichment||0)/100;return o.innerHTML=`<div class="cell cell-select"><input type="checkbox" class="row-checkbox-samples" data-id="${e.id}"></div><div class="cell cell-id">${n+1}</div><div class="cell cell-date">${t(e.date||"")}</div><div class="cell cell-inspector">${e.inspector||""}</div><div class="cell cell-executor">${e.executor||""}</div><div class="cell cell-batch">${e.batchNumber||""}</div><div class="cell cell-cont">${e.containerNumber||""}</div><div class="cell cell-jar">${e.jarNumber||""}</div><div class="cell cell-tare">${(e.tareWeight||0).toFixed(4)}</div><div class="cell cell-gross">${(e.grossWeight||0).toFixed(4)}</div><div class="cell cell-net">${(e.netWeight||0).toFixed(4)}</div><div class="cell cell-enrich">${(e.enrichment||0).toFixed(4)}</div><div class="cell cell-conc">${(e.concentration||0).toFixed(4)}</div><div class="cell cell-u">${a.toFixed(4)}</div><div class="cell cell-u235">${c.toFixed(4)}</div><div class="cell cell-pkg">${e.packageContainerNumber||""}</div><div class="cell cell-seal">${e.sealNumber||""}</div><div class="cell cell-action"><button class="delete-btn" data-id="${e.id}" style="background:#dc3545;color:white;padding:5px 10px;border-radius:8px">Удалить</button></div>`,o},d=e=>{const t=document.getElementById("samples-table-body");if(t.innerHTML="",0===e.length)return void(t.innerHTML='<div style="text-align:center;padding:2rem;width:100%">Данные отсутствуют</div>');e.forEach((e,n)=>{t.appendChild(s(e,n))})},i=()=>{const e=o.filter(e=>e.sealNumber).map(e=>({id:e.id,sealNumber:e.sealNumber,dateUsed:e.date,packageContainerNumber:e.packageContainerNumber,executor:e.inspector})).sort((e,n)=>new Date(n.dateUsed)-new Date(e.dateUsed)),n=document.getElementById("search-input-seals").value.toLowerCase(),a=e.filter(e=>Object.values(e).some(e=>String(e).toLowerCase().includes(n))),c=document.getElementById("seals-table-body");if(c.innerHTML="",0===a.length)return void(c.innerHTML='<div style="text-align:center;padding:2rem;width:100%">Пломбы не найдены</div>');a.forEach((e,n)=>{const o=document.createElement("div");o.className="table-row",o.innerHTML=`<div class="cell cell-select"><input type="checkbox" class="row-checkbox-seals" data-id="${e.id}"></div><div class="cell seals-cell-id">${n+1}</div><div class="cell seals-cell-seal">${e.sealNumber}</div><div class="cell seals-cell-date">${t(e.dateUsed)}</div><div class="cell seals-cell-pkg">${e.packageContainerNumber}</div><div class="cell seals-cell-executor">${e.executor}</div>`,c.appendChild(o)})},m=()=>{const e=document.getElementById("container-summary-grid");e.innerHTML="";const t=o.reduce((e,t)=>{const n=t.packageContainerNumber||"Не указан";e[n]||(e[n]={samples:[],totalNet:0,totalU:0,totalU235:0});const o=(t.netWeight||0)*t.concentration/100,a=o*t.enrichment/100;return e[n].samples.push(t),e[n].totalNet+=t.netWeight||0,e[n].totalU+=o,e[n].totalU235+=a,e},{});for(const n in t){const o=t[n],a=document.createElement("div");a.className="container-card glass-container",a.innerHTML=`<h3>${n}</h3><p><strong>Кол-во проб:</strong> ${o.samples.length}</p><p><strong>Масса Нетто:</strong> ${o.totalNet.toFixed(4)} г</p><p><strong>Масса U:</strong> ${o.totalU.toFixed(4)} г</p><p><strong>Масса U235:</strong> ${o.totalU235.toFixed(4)} г</p>`,e.appendChild(a)}},p=()=>{localStorage.setItem("samples",JSON.stringify(o));const e=document.getElementById("search-input-samples").value.toLowerCase(),t=o.filter(t=>Object.values(t).some(t=>String(t).toLowerCase().includes(e)));d(t),i(),(()=>{document.getElementById("total-samples").textContent=o.length;const e=o.reduce((e,t)=>e+(t.netWeight||0)*(t.concentration||0)/100,0);document.getElementById("total-u-weight").textContent=`${e.toFixed(4)} г`;const t=o.reduce((e,t)=>{const n=(t.netWeight||0)*(t.concentration||0)/100;return e+n*(t.enrichment||0)/100},0);document.getElementById("total-u235-weight").textContent=`${t.toFixed(4)} г`})(),m()};const u=(e,t="success",n=3e3,o=null)=>{const a=document.getElementById("notification-container"),c=document.createElement("div");if(c.className="notification glass-container","confirm"!==t&&(c.style.background="success"===t?"#28a745":"#dc3545"),c.textContent=e,"confirm"===t){const e=document.createElement("div");e.className="notification-buttons";const t=document.createElement("button");t.textContent="Да",t.className="notification-btn",t.onclick=()=>{o(),c.classList.remove("show"),c.addEventListener("transitionend",()=>c.remove())};const n=document.createElement("button");n.textContent="Нет",n.className="notification-btn",n.onclick=()=>{c.classList.remove("show"),c.addEventListener("transitionend",()=>c.remove())},e.append(t,n),c.appendChild(e)}a.appendChild(c),setTimeout(()=>{c.classList.add("show")},10),"confirm"!==t&&setTimeout(()=>{c.classList.remove("show"),c.addEventListener("transitionend",()=>c.remove())},n)},g=()=>{document.getElementById("add-modal").classList.add("visible")},h=()=>{document.getElementById("add-modal").classList.remove("visible")},f=e=>{let a,c;if("samples"===e){const l=Array.from(document.querySelectorAll(".row-checkbox-samples:checked")).map(e=>parseFloat(e.dataset.id));if(0===l.length)return void p("Выберите строки для экспорта","error");a=o.filter(e=>l.includes(e.id)).map(e=>{const n=(e.netWeight||0)*(e.concentration||0)/100,o=n*(e.enrichment||0)/100;return{"Дата":t(String(e.date||"")),"Исполнитель":String(e.executor||""),"Инспектор":String(e.inspector||""),"Номер партии":String(e.batchNumber||""),"Номер контейнера":String(e.containerNumber||""),"Номер баночки":String(e.jarNumber||""),"Масса тары, г":String((e.tareWeight||0).toFixed(4)),"Масса брутто, г":String((e.grossWeight||0).toFixed(4)),"Масса нетто, г":String((e.netWeight||0).toFixed(4)),"Обогащение, %":String((e.enrichment||0).toFixed(4)),"Концентрация, %":String((e.concentration||0).toFixed(4)),"Масса U":String(n.toFixed(4)),"Масса U235":String(o.toFixed(4)),"Номер упак, контейнера":String(e.packageContainerNumber||""),"Номер пломбы (S)":String(e.sealNumber||""),"Дальнейшее движение":String(e.nextMovement||"")}}),c="Журнал_проб.xlsx"}else{const e=Array.from(document.querySelectorAll(".row-checkbox-seals:checked")).map(e=>parseFloat(e.dataset.id));if(0===e.length)return void p("Выберите строки для экспорта","error");const l=o.filter(e=>e.sealNumber);a=l.filter(n=>e.includes(n.id)).map(e=>({"Номер пломбы":String(e.sealNumber),"Дата установки":t(String(e.date)),"Номер упак. контейнера":String(e.packageContainerNumber),"Кто установил":String(e.inspector)})),c="Журнал_пломб.xlsx"}try{const e=XLSX.utils.json_to_sheet(a),t=XLSX.utils.book_new();XLSX.utils.book_append_sheet(t,e,"Журнал"),XLSX.writeFile(t,c),u(`Экспорт завершен. Выгружено строк: ${a.length}.`)}catch(e){u(`Ошибка экспорта: ${e.message}`,"error")}},v=e=>{const t=e.target.files[0];if(!t)return;const a=new FileReader;a.onload=e=>{try{const t=XLSX.read(new Uint8Array(e.target.result),{type:"array",cellDates:!0}),a=XLSX.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]).map(e=>{const t=parseFloat(e["Масса брутто, г"]||0),a=parseFloat(e["Масса тары, г"]||0);if(isNaN(t)||isNaN(a))throw new Error("Неверный формат чисел в полях масс.");return{id:Date.now()+Math.random(),date:e["Дата"]?n(e["Дата"]).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],executor:e["Исполнитель"]||"",inspector:e["Инспектор"]||"",batchNumber:e["Номер партии"]||"",containerNumber:e["Номер контейнера"]||"",jarNumber:e["Номер баночки"]||"",tareWeight:a,grossWeight:t,netWeight:t-a,enrichment:parseFloat(e["Обогащение, %"]||0),concentration:parseFloat(e["Концентрация, %"]||0),packageContainerNumber:String(e["Номер упак, контейнера"]||""),sealNumber:String(e["Номер пломбы (S)"]||""),nextMovement:e["Дальнейшее движение"]||"",isNew:!0}});o.unshift(...a.reverse()),p(),u(`Успешно импортировано ${a.length} записей!`)}catch(e){u(`Ошибка импорта: ${e.message}. Проверьте формат файла.`,"error",5000)}finally{document.getElementById("import-file-input-samples").value=""}},a.readAsArrayBuffer(t)};const y=()=>{c=(c+1)%a.length,l(a[c])};document.getElementById("theme-switcher-samples").addEventListener("click",y),document.getElementById("theme-switcher-seals").addEventListener("click",y);const E=e=>{r(e.target.value)};document.getElementById("scale-slider-samples").addEventListener("input",E),document.getElementById("scale-slider-seals").addEventListener("input",E),document.getElementById("add-sample-form").addEventListener("submit",e=>{e.preventDefault();const t={date:document.getElementById("date").value,executor:document.getElementById("executor").value,inspector:document.getElementById("inspector").value,batchNumber:document.getElementById("batch-number").value,containerNumber:document.getElementById("container-number").value,jarNumber:document.getElementById("jar-number").value,tareWeight:parseFloat(document.getElementById("tare-weight").value),grossWeight:parseFloat(document.getElementById("gross-weight").value),enrichment:parseFloat(document.getElementById("enrichment").value)||0,concentration:parseFloat(document.getElementById("concentration").value)||0,packageContainerNumber:"Т-"+document.getElementById("package-container-number").value.trim(),sealNumber:document.getElementById("seal-number").value.trim(),nextMovement:document.getElementById("next-movement").value};if(t.netWeight=t.grossWeight-t.tareWeight,t.grossWeight<t.tareWeight)return u("Брутто не может быть меньше тары.","error");o.unshift({id:Date.now()+Math.random(),...t,isNew:!0}),p(),document.getElementById("add-sample-form").reset(),document.getElementById("date").valueAsDate=new Date,h(),u("Проба успешно добавлена.")}),document.getElementById("samples-table-body").addEventListener("click",e=>{if(e.target.classList.contains("delete-btn")){const t=parseFloat(e.target.getAttribute("data-id"));u("Удалить эту запись?","confirm",0,()=>{o=o.filter(e=>e.id!==t),p(),u("Запись удалена.")})}}),document.getElementById("package-container-number").addEventListener("input",e=>{const t=e.target.value.trim();if(!t)return void(document.getElementById("seal-number").value="");const n="Т-"+t,a=o.find(e=>e.packageContainerNumber===n);a&&(document.getElementById("seal-number").value=a.sealNumber||"")}),document.addEventListener("change",e=>{e.target&&"select-all-checkbox-samples"===e.target.id&&document.querySelectorAll(".row-checkbox-samples").forEach(t=>t.checked=e.target.checked),e.target&&"select-all-checkbox-seals"===e.target.id&&document.querySelectorAll(".row-checkbox-seals").forEach(t=>t.checked=e.target.checked)}),document.getElementById("search-input-samples").addEventListener("input",p),document.getElementById("search-input-seals").addEventListener("input",i),document.getElementById("fab-add-btn").addEventListener("click",g),document.getElementById("modal-close-btn").addEventListener("click",h),document.getElementById("add-modal").addEventListener("click",e=>{e.target===document.getElementById("add-modal")&&h()}),document.getElementById("export-btn-samples").addEventListener("click",()=>f("samples")),document.getElementById("export-btn-seals").addEventListener("click",()=>f("seals")),document.getElementById("import-btn-samples").addEventListener("click",()=>document.getElementById("import-file-input-samples").click()),document.getElementById("import-file-input-samples").addEventListener("change",v),document.getElementById("save-btn-samples").addEventListener("click",()=>{localStorage.setItem("samples",JSON.stringify(o)),u("Данные сохранены!")}),document.getElementById("delete-all-btn-samples").addEventListener("click",()=>{u("Вы уверены, что хотите удалить ВСЕ записи?","confirm",0,()=>{o=[],p(),u("Все записи удалены.","success")})});const b=document.getElementById("summary-dots-samples").children,k=document.getElementById("summary-slider-samples");for(let e=0;e<b.length;e++)b[e].addEventListener("click",()=>{const t=-50*e;k.style.transform=`translateX(${t}%)`,w(e)});let w=0;const L=document.getElementById("summary-wrapper-samples");L.addEventListener("touchstart",e=>{w=e.changedTouches[0].screenX},{passive:!0}),L.addEventListener("touchend",e=>{const t=e.changedTouches[0].screenX;t<w-50&&(k.style.transform="translateX(-50%)",S(1)),t>w+50&&(k.style.transform="translateX(0%)",S(0))},{passive:!0});const S=e=>{for(let t=0;t<b.length;t++)b[t].classList.toggle("active",t===e)};const x=localStorage.getItem("theme")||'light';c=a.indexOf(x),l(x),r(localStorage.getItem("scale")||100),document.getElementById("date").valueAsDate=new Date,p()});</script></body></html>